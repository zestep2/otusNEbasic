#  Лабораторная работа. Доступ к сетевым устройствам по протоколу SSH

#### Топология
![alt text](image.png)

#### Таблица адресации
| Устройство | Интерфейс  | IP-адрес     | Маска подсети    | Шлюз по умолчанию |
|------------|------------|--------------|------------------|-------------------|
| R1         | G0/0/1     | 192.168.1.1  | 255.255.255.0    | —                 |
| S1         | VLAN 1     | 192.168.1.11 | 255.255.255.0    | 192.168.1.1       |
| PC-A       | NIC        | 192.168.1.3  | 255.255.255.0    | 192.168.1.1       |
#### Задачи:
1. [Часть 1. Настройка основных параметров устройства](#часть-1-настройка-основных-параметров-устройства)  
2. [Часть 2. Настройка маршрутизатора для доступа по протоколу SSH](#часть-2-настройка-маршрутизатора-для-доступа-по-протоколу-ssh)  
3. [Часть 3. Настройка коммутатора для доступа по протоколу SSH](#часть-3-настройка-коммутатора-для-доступа-по-протоколу-ssh)  
4. [Часть 4. SSH через интерфейс командной строки (CLI) коммутатора](#часть-4-ssh-через-интерфейс-командной-строки-cli-коммутатора)  


### Часть 1. Настройка основных параметров устройства
Подключаем сеть в соответствии с топологией, настраиваем узлы в соответсвии с топологией, настриваем базовые параметры коммутатора и маршрутизатора

[Итоговый файл cpt для этой лабораторной](./lab_cpt.pkt)



[Базовая настройка маршрутизатора R1](./R1_conf)

### Часть 2. Настройка маршрутизатора для доступа по протоколу SSH

### Шаг 1. Настройте аутентификацию устройств
Имя устройству задали ранее, поэтому добавляем только домен для устройства

`ip domain-name skynet`

### Шаг 2. Создайте ключ шифрования с указанием его длины
генерим ключ rsa длиной 2048 бит:

`crypto key generate rsa general-keys modulus 2048`

Переключаем SSH на версию 2:

`ip ssh version 2`

###  Шаг 3. Создайте имя пользователя в локальной базе учетных записей

Создаем пользователя с максимальными привилегиями и паролем:

`username admin privilege 15 secret Adm1nP @55`

### Шаг 4. Активируйте протокол SSH на линиях VTY
```
line vty 0 4
transport input ssh
```
Изменяем способ входа в систему таким образом, чтобы использовалась проверка пользователей по локальной базе учетных записей:

`login local`

### Шаг 5. Сохраните текущую конфигурацию в файл загрузочной конфигурации

`write`

### Шаг 6. Установите соединение с маршрутизатором по протоколу SSH
С помощью команды ssh заходит из терминала PC-A на роутер R1:
```
C:\>ssh -l admin 192.168.1.1

Password: 


Unauthorized access is strictly prohibited. 

R1#
```

Все успешно!

## Часть 3. Настройка коммутатора для доступа по протоколу SSH


### Шаг 1. Настройте основные параметры коммутатора

[Базовая настройка коммутатора S1](./S1_conf)

### Шаг 2. Настройте коммутатор для соединения по протоколу SSH
```
ip domain-name skynet
crypto key generate rsa general-keys modulus 2048
ip ssh version 2
username admin privilege 15 secret Adm1nP @55
line vty 0 4
transport input ssh
login local 
end
write
```

### Шаг 3. Установите соединение с коммутатором по протоколу SSH

C:\>ssh -l admin 192.168.1.11
```
Password: 


Unauthorized access is strictly prohibited. 

S1#
```

Соединение по SSH успешно установлено, ура!

## Часть 4. SSH через интерфейс командной строки (CLI) коммутатора
### Шаг 1. Посмотрите доступные параметры для клиента SSH в Cisco IOS
```
S1#ssh ?
  -l  Log in using this user name
  -v  Specify SSH Protocol Version
```
### Шаг 2. Установите с коммутатора S1 соединение с маршрутизатором R1 по протоколу SSH
```
S1#ssh -l admin 192.168.1.1

Password: 


Unauthorized access is strictly prohibited. 

R1#
```

Пробуем вернуться к коммутатора не закрывая сеанс с роутером, возвращаться в сеанс и завершаем его:
```
R1#
S1#
S1#
[Resuming connection 1 to 192.168.1.1 ... ]

R1#exit

[Connection to 192.168.1.1 closed by foreign host]
S1#
```

Все удачно!

### Вопрос: Какие версии протокола SSH поддерживаются при использовании интерфейса командной строки?

Видимо, версии 1 и 2.

### Вопрос: Как предоставить доступ к сетевому устройству нескольким пользователям, у каждого из которых есть собственное имя пользователя?

Создать для каждого пользователя локальную учетную запись на каждом устройстве (но есть варианты и получше)

